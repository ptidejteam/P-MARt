<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Helpful Methods in the
  Macros Class</title><meta name="generator" content="DocBook XSL Stylesheets V1.59.2"><link rel="home" href="index.html" title="jEdit 4.1 User's Guide"><link rel="up" href="macro-basics.html" title="Chapter 12. Macro Basics"><link rel="previous" href="predefined-variables.html" title="Predefined Variables in BeanShell"><link rel="next" href="dynamic-typing.html" title="BeanShell Dynamic Typing"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Helpful Methods in the
  Macros Class</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="predefined-variables.html">Prev</a> </td><th width="60%" align="center">Chapter 12. Macro Basics</th><td width="20%" align="right"> <a accesskey="n" href="dynamic-typing.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="helpful-methods"></a>Helpful Methods in the
  Macros Class</h2></div></div><p>
   Including <tt>message()</tt>, there are five static methods
   in the <tt>Macros</tt> class that allow you to converse
   easily with your macros. They all encapsulate calls to methods of the
   Java platform's <tt>JOptionPane</tt> class.
  </p><div class="itemizedlist"><ul type="disc"><li><div class="funcsynopsis"><table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0"><tr><td><code class="funcdef">public static void <b class="fsfunc">message</b>(</code></td><td>Component  </td><td><var class="pdparam">comp</var>, </td></tr><tr><td> </td><td>String  </td><td><var class="pdparam">message</var><code>)</code>;</td></tr></table></div></li><li><div class="funcsynopsis"><table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0"><tr><td><code class="funcdef">public static void <b class="fsfunc">error</b>(</code></td><td>Component  </td><td><var class="pdparam">comp</var>, </td></tr><tr><td> </td><td>String  </td><td><var class="pdparam">message</var><code>)</code>;</td></tr></table></div></li><li><div class="funcsynopsis"><table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0"><tr><td><code class="funcdef">public static String <b class="fsfunc">input</b>(</code></td><td>Component  </td><td><var class="pdparam">comp</var>, </td></tr><tr><td> </td><td>String  </td><td><var class="pdparam">prompt</var><code>)</code>;</td></tr></table></div></li><li><div class="funcsynopsis"><table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0"><tr><td><code class="funcdef">public static String <b class="fsfunc">input</b>(</code></td><td>Component  </td><td><var class="pdparam">comp</var>, </td></tr><tr><td> </td><td>String  </td><td><var class="pdparam">prompt</var>, </td></tr><tr><td> </td><td>String  </td><td><var class="pdparam">defaultValue</var><code>)</code>;</td></tr></table></div></li><li><div class="funcsynopsis"><table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0"><tr><td><code class="funcdef">public static int <b class="fsfunc">confirm</b>(</code></td><td>Component  </td><td><var class="pdparam">comp</var>, </td></tr><tr><td> </td><td>String  </td><td><var class="pdparam">prompt</var>, </td></tr><tr><td> </td><td>int  </td><td><var class="pdparam">buttons</var><code>)</code>;</td></tr></table></div></li></ul></div><p>
    The format of these four <i>declarations</i> provides a
    concise reference to the way in which the methods may be used. The
    keyword <tt>public</tt> means that the method can be used
    outside the <tt>Macros</tt> class. The alternatives are
    <tt>private</tt> and <tt>protected</tt>. For
    purposes of BeanShell, you just have to know that BeanShell can only use
    public methods of other Java classes. The keyword
    <tt>static</tt> we have already discussed. It means that the
    method does not operate on a particular object. You call a static
    function using the name of the class (like
    <tt>Macros</tt>) rather than the name of a particular
    object (like <tt>view</tt>). The third word is the type of the
    value returned by the method. The keyword <tt>void</tt> is
    Java's way of saying the the method does not have a return value.
  </p><p>
   The <tt>error()</tt> method works just like
   <tt>message()</tt> but displays an error icon in the message
   box. The <tt>input()</tt> method furnishes a text field for
   input, an <b>OK</b> button and a
   <b>Cancel</b> button. If <b>Cancel</b> is pressed,
   the method returns <tt>null</tt>. If <b>OK</b>
   is pressed, a <tt>String</tt> containing the contents of
   the text field is returned. Note that there are two forms of the
   <tt>input()</tt> method; the first form with two parameters
   displays an empty input field, the other forms lets you specify an initial,
   default input value.
  </p><p>
   For those without Java experience, it is important to know that
   <tt>null</tt> is <span class="emphasis"><em>not</em></span> the same as an
   empty, &#8220;zero-length&#8221; <tt>String</tt>. It is
   Java's way of saying that there is no object associated with this
   variable. Whenever you seek to use a return value from
   <tt>input()</tt> in your macro, you should test it to see if
   it is <tt>null</tt>. In most cases, you will
   want to exit gracefully from the script with a
   <tt>return</tt> statement, because the presence of a null
   value for an input variable usually means that the user intended to
   cancel macro execution. BeanShell will complain if you call any
   methods on a <tt>null</tt> object.
  </p><p>
   The <tt>confirm()</tt> method in the
   <tt>Macros</tt> class is a little more complex. The
   <tt>buttons</tt> parameter has an <tt>int</tt>
   type, and the usual way to supply a value is to use one of
   the predefined values taken from Java's
   <tt>JOptionPane</tt> class. You can choose among
   <tt>JOptionPane.YES_NO_OPTION</tt>,
   <tt>JOptionPane.YES_NO_CANCEL_OPTION</tt>, or
   <tt>JOptionPane.OK_CANCEL_OPTION</tt>. The return
   value of the method is also an <tt>int</tt>, and should be tested
   against the value of other predefined constants:
   <tt>JOptionPane.YES_OPTION</tt>,
   <tt>JOptionPane.NO_OPTION</tt>,
   <tt>JOptionPane.OK_OPTION</tt> or
   <tt>JOptionPane.CANCEL_OPTION</tt>.
  </p><p>
   We've looked at using <tt>Macros.message()</tt>. To
   use the other methods, you would write something like the
   following:
  </p><div class="informalexample"><table border="0" bgcolor="#E0E0E0"><tr><td><pre class="programlisting">Macros.error(view, &quot;Goodbye, cruel world!&quot;);

String result = Macros.input(view, &quot;Type something here.&quot;);

String result = Macros.input(view, &quot;When were you born?&quot;,
    &quot;I don't remember, I was very young at the time&quot;);

int result = Macros.confirm(&quot;Do you really want to learn&quot;
    + &quot; about BeanShell?&quot;,JOptionPane.YES_NO_OPTION);
    </pre></td></tr></table></div><p>
    In the last three examples, placing the word <tt>String</tt>
    or <tt>int</tt>
    before the variable name <tt>result</tt> tells BeanShell that
    the variable refers to an integer or a <tt>String</tt> object, even
    before a particular value is assigned to the variable.
    In BeanShell, this <i>declaration</i> of the
    <i>type</i> of <tt>result</tt> is not
    necessary; BeanShell can figure it out when the macro runs. This can be
    helpful if you are not comfortable with specifying types and classes;
    just use your variables and let BeanShell worry about it.
  </p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="predefined-variables.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="macro-basics.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="dynamic-typing.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Predefined Variables in BeanShell </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> BeanShell Dynamic Typing</td></tr></table></div></body></html>
