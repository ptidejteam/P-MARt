<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Advanced BeanShell Techniques</title><meta name="generator" content="DocBook XSL Stylesheets V1.59.2"><link rel="home" href="index.html" title="jEdit 4.1 User's Guide"><link rel="up" href="macro-tips.html" title="Chapter 14. Macro Tips and Techniques"><link rel="previous" href="scripts-command-line.html" title="Running Scripts from the Command
Line"><link rel="next" href="macro-tips-debugging.html" title="Debugging Macros"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Advanced BeanShell Techniques</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="scripts-command-line.html">Prev</a> </td><th width="60%" align="center">Chapter 14. Macro Tips and Techniques</th><td width="20%" align="right"> <a accesskey="n" href="macro-tips-debugging.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="macro-tips-BeanShell"></a>Advanced BeanShell Techniques</h2></div></div><p>
  BeanShell has a few advanced features that we haven't mentioned yet.
  They will be discussed in this section.
</p><div class="sect2" lang="en"><div class="titlepage"><div><h3 class="title"><a name="macro-tips-BeanShell-convenience"></a>BeanShell's Convenience Syntax</h3></div></div><p>
  We noted earlier that BeanShell syntax does not require that variables
  be declared or defined with their type, and that variables that are
  not typed when first used can have values of differing types assigned
  to them. In addition to this &#8220;loose&#8221; syntax, BeanShell
  allows a &#8220;convenience&#8221; syntax for dealing with the
  properties of JavaBeans.  They may be accessed or set as if they were
  data members. They may also be accessed using the name of the property
  enclosed in quotation marks and curly brackets.  For example, the following
  statement are all equivalent, assuming <tt>btn</tt> is
  a <tt>JButton</tt> instance:
</p><div class="informalexample"><table border="0" bgcolor="#E0E0E0"><tr><td><pre class="programlisting">b.setText(&quot;Choose&quot;);
b.text = &quot;Choose&quot;;
b{&quot;text&quot;} = &quot;Choose&quot;;
</pre></td></tr></table></div><p>
  The last form can also be used to access a key-value pair of a
  <tt>Hashtable</tt> object.
</p></div><div class="sect2" lang="en"><div class="titlepage"><div><h3 class="title"><a name="macro-tips-BeanShell-keywords"></a>Special BeanShell Keywords</h3></div></div><p>
  BeanShell uses special keywords to refer to variables or methods defined in
  the current or an enclosing block's scope:
</p><div class="itemizedlist"><ul type="disc"><li><p>
      The keyword <tt>this</tt> refers to the current scope.
    </p></li><li><p>
      The keyword <tt>super</tt> refers to the immediately
      enclosing scope.
    </p></li><li><p>
      The keyword <tt>global</tt> refers to the top-level
      scope of the macro script.
    </p></li></ul></div><p>
  The following script illustrates the use of these keywords:
</p><div class="informalexample"><table border="0" bgcolor="#E0E0E0"><tr><td><pre class="programlisting">a = &quot;top\n&quot;;
foo() {
    a = &quot;middle\n&quot;;
    bar() {
        a = &quot;bottom\n&quot;;
        textArea.setSelectedText(global.a);
        textArea.setSelectedText(super.a);
        // equivalent to textArea.setSelectedText(this.a):
        textArea.setSelectedText(a);
    }

    bar();
}
foo();</pre></td></tr></table></div><p>
  When the script is run, the following text is inserted in the current
  buffer:
</p><table border="0" bgcolor="#E0E0E0"><tr><td><pre class="screen">top
middle
bottom</pre></td></tr></table></div><div class="sect2" lang="en"><div class="titlepage"><div><h3 class="title"><a name="macro-tips-BeanShell-interface"></a>Implementing Interfaces</h3></div></div><p>
  As discussed in the macro example in <a href="dialog-macro.html" title="Chapter 13. A Dialog-Based Macro">Chapter 13</a>, scripted objects can implement Java
  interfaces such as <tt>ActionListener</tt>.  Which
  interfaces may be implemented varies depending upon the
  version of the Java runtime environment being used. If running under
  Java 1.1 or 1.2, BeanShell objects can only implement the AWT or
  Swing event listener interfaces contained in the
  <tt>java.awt.event</tt> and <tt>javax.swing.event</tt>
  packages, along with the <tt>java.lang.Runnable</tt> interface.
  If BeanShell is running under Java 1.3 or 1.4, which jEdit 4.0 requires, any
  interface can be implemented.
</p><p>
  Frequently it will not be necessary to implement all of the methods of
  a particular interface in order to specify the behavior of a scripted
  object. Under Java 1.3 and above, the virtual machine's reflection
  mechanism will throw an exception for any
  missing interface methods.  This will bring macro execution to a
  halt unless the exception is trapped and handled.  The solution
  is to implement the <tt>invoke()</tt> method,
  which is called when an undefined method is invoked on a scripted
  object. Typically, the implementation of this method will do nothing,
  as in the following example:
</p><div class="informalexample"><table border="0" bgcolor="#E0E0E0"><tr><td><pre class="programlisting">invoke(method, args) {}</pre></td></tr></table></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="scripts-command-line.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="macro-tips.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="macro-tips-debugging.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Running Scripts from the Command
Line </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Debugging Macros</td></tr></table></div></body></html>
